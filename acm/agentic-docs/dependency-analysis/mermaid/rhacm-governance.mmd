graph TB
    %% RHACM Governance, Risk & Compliance - Real Components Only
    
    %% Policy Creation & Management Tools
    POLICY_GEN[policy-generator-plugin]
    POLICY_CLI[policy-cli]
    ACM_CLI[acm-cli]
    POLICY_COLLECTION[policy-collection]
    
    %% Enhanced ACM CLI Distribution System
    CLI_DISTRIBUTION_SERVER[ACM CLI Distribution Server]
    CLI_BINARY_AGGREGATOR[CLI Binary Aggregator]
    CLI_PACKAGER[CLI Packager]
    POLICY_GENERATOR_CLI[Policy Generator CLI]
    CONSOLE_CLI_DOWNLOAD[ConsoleCLIDownload Integration]
    
    %% Hub Policy Controllers
    GOV_POLICY_PROP[governance-policy-propagator]
    GOV_POLICY_FRAMEWORK[governance-policy-framework]
    GOV_POLICY_ADDON_CTRL[governance-policy-addon-controller]
    
    %% Policy Type Controllers
    CONFIG_POLICY_CTRL[config-policy-controller]
    CERT_POLICY_CTRL[cert-policy-controller]
    IAM_POLICY_CTRL[iam-policy-controller]
    
    %% Enhanced Policy-Generator Components
    POLICY_GENERATOR_CR[PolicyGenerator Custom Resource]
    PLUGIN_PROCESSING_ENGINE[Plugin Processing Engine]
    POLICY_EXPANDERS[Policy Expanders System]
    
    %% Enhanced Governance-Policy-Propagator Controllers
    ROOT_POLICY_RECONCILER[RootPolicyReconciler]
    REPLICATED_POLICY_RECONCILER[ReplicatedPolicyReconciler]
    ROOT_POLICY_STATUS_RECONCILER[RootPolicyStatusReconciler]
    POLICY_SET_RECONCILER[PolicySetReconciler]
    POLICY_AUTOMATION_RECONCILER[PolicyAutomationReconciler]
    ENCRYPTION_KEYS_RECONCILER[EncryptionKeysReconciler]
    
    %% Enhanced Addon Controller Components
    ADDON_FACTORY[Addon Factory Pattern]
    ADDON_MANAGER[Addon Manager]
    GOV_STANDALONE_HUB_TEMPLATING[governance-standalone-hub-templating]
    
    %% Enhanced Framework Addon Controllers
    SPEC_SYNC_CTRL[Spec Sync Controller]
    STATUS_SYNC_CTRL[Status Sync Controller]
    TEMPLATE_SYNC_CTRL[Template Sync Controller]
    SECRET_SYNC_CTRL[Secret Sync Controller]
    GATEKEEPER_SYNC_CTRL[Gatekeeper Sync Controller]
    
    %% Enhanced Config-Policy-Controller Components
    CONFIGURATION_POLICY_RECONCILER[ConfigurationPolicyReconciler]
    OPERATOR_POLICY_RECONCILER[OperatorPolicyReconciler]
    DYNAMIC_WATCHER[Dynamic Watcher System]
    TEMPLATE_ENGINE[Template Engine]
    NAMESPACE_SELECTOR[Namespace Selector]
    
    %% Advanced Template Processing Engine
    TEMPLATE_PROCESSING_ENGINE[Template Processing Engine]
    HUB_DYNAMIC_WATCHER[Hub Dynamic Watcher]
    GOLANG_TEMPLATE_RESOLVER[Golang Template Resolver]
    TEMPLATE_ENCRYPTION_ENGINE[Template Encryption Engine]
    OBJECT_EVALUATOR[Object Evaluator]
    NAMESPACE_SELECTOR_RECONCILER[Namespace Selector Reconciler]
    OLM_HANDLERS[OLM Resource Handlers]
    
    %% Template Functions Suite
    FROM_SECRET_FUNC[fromSecret Template Function]
    FROM_CONFIGMAP_FUNC[fromConfigMap Template Function]
    FROM_CLUSTERCLAIM_FUNC[fromClusterClaim Template Function]
    LOOKUP_FUNC[Generic Lookup Template Function]
    SPRIG_FUNCTIONS[Sprig Template Functions]
    
    %% Enhanced Certificate Policy Controller Components
    CERT_VALIDATION_ENGINE[Certificate Validation Engine]
    DURATION_VALIDATORS[Duration Validators]
    SAN_PATTERN_VALIDATORS[SAN Pattern Validators]
    CERT_DISCOVERY_ENGINE[Certificate Discovery Engine]
    CERT_COMPLIANCE_REPORTER[Certificate Compliance Reporter]
    
    %% Policy Compliance & Remediation Engines
    COMPLIANCE_EVALUATOR[Multi-State Compliance Evaluator]
    REMEDIATION_ENGINE[Policy Remediation Engine]
    EVENT_GENERATOR[Policy Event Generator]
    METRICS_EXPORTER[Policy Metrics Exporter]
    
    %% Enhanced Policy Propagator Components
    POLICY_PROPAGATOR_CTRL[Policy Propagator Controller]
    PLACEMENT_BINDING_HANDLER[PlacementBinding Event Handler]
    PLACEMENT_DECISION_HANDLER[Placement Decision Handler]
    PLACEMENT_RULE_HANDLER[PlacementRule Event Handler]
    TEMPLATE_RESOLVERS[Template Resolvers]
    RESOURCE_VERSION_TRACKER[Resource Version Tracker]
    STATUS_AGGREGATION_ENGINE[Status Aggregation Engine]
    ROOT_COMPLIANCE_CALCULATOR[Root Compliance Calculator]
    ENCRYPTION_SYSTEM[Template Encryption System]
    
    %% IAM Policy Controller Internals
    IAM_POLICY_RECONCILER[IAM Policy Reconciler]
    CLUSTER_ROLE_BINDING_VALIDATOR[Cluster Role Binding Validator]
    IAM_COMPLIANCE_REPORTER[IAM Compliance Reporter]
    USER_THRESHOLD_VALIDATOR[User Threshold Validator]
    CLUSTER_ADMIN_MONITOR[Cluster Admin Monitor]
    
    %% Kubernetes Dependency Watching System
    DEPENDENCY_WATCHER[Kubernetes Dependency Watcher]
    CONTROLLER_RUNTIME_SOURCE[Controller Runtime Source]
    DEPENDENCY_TRACKER[Dependency Tracker]
    EVENT_CHANNEL_BRIDGE[Event Channel Bridge]
    
    %% Must-Gather Diagnostic System
    MUST_GATHER_ENGINE[Must-Gather Engine]
    HUB_DATA_COLLECTOR[Hub Data Collector]
    MANAGED_CLUSTER_COLLECTOR[Managed Cluster Collector]
    HOSTED_CLUSTER_COLLECTOR[Hosted Cluster Collector]
    POD_DATA_COLLECTOR[Pod Data Collector]
    RESOURCE_ORGANIZER[Resource Organizer]
    DIAGNOSTIC_AGGREGATOR[Diagnostic Aggregator]
    
    %% OPA Gatekeeper Components
    GATEKEEPER[gatekeeper]
    GATEKEEPER_OP[gatekeeper-operator]
    GATEKEEPER_FBC[gatekeeper-operator-fbc]
    
    %% Spoke Components
    KLUSTERLET_ADDON_CTRL[klusterlet-addon-controller]
    GOV_POLICY_FRAMEWORK_ADDON[governance-policy-framework-addon]
    
    %% Infrastructure
    K8S_DEPENDENCY_WATCHES[kubernetes-dependency-watches]
    MUST_GATHER[must-gather]
    
    %% Enhanced Policy Creation & Management Flow
    POLICY_CLI -->|CREATES_POLICIES| GOV_POLICY_PROP
    ACM_CLI -->|CREATES_POLICIES| GOV_POLICY_PROP
    POLICY_GEN -->|USES| POLICY_GENERATOR_CR
    POLICY_GENERATOR_CR -->|PROCESSED_BY| PLUGIN_PROCESSING_ENGINE
    PLUGIN_PROCESSING_ENGINE -->|USES| POLICY_EXPANDERS
    POLICY_GEN -->|GENERATES_POLICIES| POLICY_COLLECTION
    POLICY_COLLECTION -->|FEEDS_POLICIES| GOV_POLICY_PROP
    
    %% Enhanced Governance-Policy-Propagator Internal Architecture
    GOV_POLICY_PROP -->|CONTAINS| ROOT_POLICY_RECONCILER
    GOV_POLICY_PROP -->|CONTAINS| REPLICATED_POLICY_RECONCILER
    GOV_POLICY_PROP -->|CONTAINS| ROOT_POLICY_STATUS_RECONCILER
    GOV_POLICY_PROP -->|CONTAINS| POLICY_SET_RECONCILER
    GOV_POLICY_PROP -->|CONTAINS| POLICY_AUTOMATION_RECONCILER
    GOV_POLICY_PROP -->|CONTAINS| ENCRYPTION_KEYS_RECONCILER
    
    %% Enhanced Hub Policy Framework
    GOV_POLICY_PROP -->|PROPAGATES_TO| GOV_POLICY_FRAMEWORK
    GOV_POLICY_FRAMEWORK -->|ORCHESTRATES| GOV_POLICY_ADDON_CTRL
    
    %% Enhanced Addon Controller Architecture
    GOV_POLICY_ADDON_CTRL -->|USES| ADDON_FACTORY
    ADDON_FACTORY -->|CREATES| ADDON_MANAGER
    ADDON_MANAGER -->|MANAGES| GOV_POLICY_FRAMEWORK_ADDON
    ADDON_MANAGER -->|MANAGES| CONFIG_POLICY_CTRL
    ADDON_MANAGER -->|MANAGES| GOV_STANDALONE_HUB_TEMPLATING
    ADDON_MANAGER -->|MANAGES| CERT_POLICY_CTRL
    ADDON_MANAGER -->|MANAGES| IAM_POLICY_CTRL
    
    %% Enhanced Framework Addon Internal Controllers
    GOV_POLICY_FRAMEWORK_ADDON -->|CONTAINS| SPEC_SYNC_CTRL
    GOV_POLICY_FRAMEWORK_ADDON -->|CONTAINS| STATUS_SYNC_CTRL
    GOV_POLICY_FRAMEWORK_ADDON -->|CONTAINS| TEMPLATE_SYNC_CTRL
    GOV_POLICY_FRAMEWORK_ADDON -->|CONTAINS| SECRET_SYNC_CTRL
    GOV_POLICY_FRAMEWORK_ADDON -->|CONTAINS| GATEKEEPER_SYNC_CTRL
    
    %% Enhanced Config-Policy-Controller Internal Architecture
    CONFIG_POLICY_CTRL -->|CONTAINS| CONFIGURATION_POLICY_RECONCILER
    CONFIG_POLICY_CTRL -->|CONTAINS| OPERATOR_POLICY_RECONCILER
    CONFIG_POLICY_CTRL -->|USES| DYNAMIC_WATCHER
    CONFIG_POLICY_CTRL -->|USES| TEMPLATE_ENGINE
    CONFIG_POLICY_CTRL -->|USES| NAMESPACE_SELECTOR
    
    %% Enhanced Template Processing Architecture
    CONFIG_POLICY_CTRL -->|CONTAINS| TEMPLATE_PROCESSING_ENGINE
    TEMPLATE_PROCESSING_ENGINE -->|CONTAINS| HUB_DYNAMIC_WATCHER
    TEMPLATE_PROCESSING_ENGINE -->|CONTAINS| GOLANG_TEMPLATE_RESOLVER
    TEMPLATE_PROCESSING_ENGINE -->|CONTAINS| TEMPLATE_ENCRYPTION_ENGINE
    CONFIGURATION_POLICY_RECONCILER -->|USES| OBJECT_EVALUATOR
    CONFIGURATION_POLICY_RECONCILER -->|USES| NAMESPACE_SELECTOR_RECONCILER
    OPERATOR_POLICY_RECONCILER -->|USES| OLM_HANDLERS
    
    %% Template Functions Integration
    GOLANG_TEMPLATE_RESOLVER -->|PROVIDES| FROM_SECRET_FUNC
    GOLANG_TEMPLATE_RESOLVER -->|PROVIDES| FROM_CONFIGMAP_FUNC
    GOLANG_TEMPLATE_RESOLVER -->|PROVIDES| FROM_CLUSTERCLAIM_FUNC
    GOLANG_TEMPLATE_RESOLVER -->|PROVIDES| LOOKUP_FUNC
    GOLANG_TEMPLATE_RESOLVER -->|INTEGRATES| SPRIG_FUNCTIONS
    
    %% Enhanced Certificate Policy Controller Architecture
    CERT_POLICY_CTRL -->|CONTAINS| CERT_VALIDATION_ENGINE
    CERT_VALIDATION_ENGINE -->|CONTAINS| DURATION_VALIDATORS
    CERT_VALIDATION_ENGINE -->|CONTAINS| SAN_PATTERN_VALIDATORS
    CERT_POLICY_CTRL -->|CONTAINS| CERT_DISCOVERY_ENGINE
    CERT_POLICY_CTRL -->|CONTAINS| CERT_COMPLIANCE_REPORTER
    
    %% Policy Compliance & Remediation Integration
    CONFIG_POLICY_CTRL -->|USES| COMPLIANCE_EVALUATOR
    CONFIG_POLICY_CTRL -->|USES| REMEDIATION_ENGINE
    CONFIG_POLICY_CTRL -->|USES| EVENT_GENERATOR
    CONFIG_POLICY_CTRL -->|EXPOSES| METRICS_EXPORTER
    CERT_POLICY_CTRL -->|USES| COMPLIANCE_EVALUATOR
    CERT_POLICY_CTRL -->|USES| EVENT_GENERATOR
    CERT_POLICY_CTRL -->|EXPOSES| METRICS_EXPORTER
    
    %% ACM CLI Distribution Architecture
    ACM_CLI -->|CONTAINS| CLI_DISTRIBUTION_SERVER
    CLI_DISTRIBUTION_SERVER -->|USES| CLI_BINARY_AGGREGATOR
    CLI_DISTRIBUTION_SERVER -->|USES| CLI_PACKAGER
    CLI_BINARY_AGGREGATOR -->|AGGREGATES| POLICY_CLI
    CLI_BINARY_AGGREGATOR -->|AGGREGATES| POLICY_GENERATOR_CLI
    CLI_DISTRIBUTION_SERVER -->|INTEGRATES_WITH| CONSOLE_CLI_DOWNLOAD
    
    %% Enhanced Policy Propagator Architecture
    GOV_POLICY_PROP -->|CONTAINS| POLICY_PROPAGATOR_CTRL
    POLICY_PROPAGATOR_CTRL -->|USES| PLACEMENT_BINDING_HANDLER
    POLICY_PROPAGATOR_CTRL -->|USES| PLACEMENT_DECISION_HANDLER
    POLICY_PROPAGATOR_CTRL -->|USES| PLACEMENT_RULE_HANDLER
    POLICY_PROPAGATOR_CTRL -->|USES| TEMPLATE_RESOLVERS
    POLICY_PROPAGATOR_CTRL -->|USES| RESOURCE_VERSION_TRACKER
    POLICY_PROPAGATOR_CTRL -->|CONTAINS| STATUS_AGGREGATION_ENGINE
    STATUS_AGGREGATION_ENGINE -->|USES| ROOT_COMPLIANCE_CALCULATOR
    TEMPLATE_RESOLVERS -->|USES| ENCRYPTION_SYSTEM
    
    %% IAM Policy Controller Architecture
    IAM_POLICY_CTRL -->|CONTAINS| IAM_POLICY_RECONCILER
    IAM_POLICY_RECONCILER -->|USES| CLUSTER_ROLE_BINDING_VALIDATOR
    IAM_POLICY_RECONCILER -->|USES| IAM_COMPLIANCE_REPORTER
    CLUSTER_ROLE_BINDING_VALIDATOR -->|CONTAINS| USER_THRESHOLD_VALIDATOR
    CLUSTER_ROLE_BINDING_VALIDATOR -->|MONITORS| CLUSTER_ADMIN_MONITOR
    
    %% Kubernetes Dependency Watching Integration
    K8S_DEPENDENCY_WATCHES -->|CONTAINS| DEPENDENCY_WATCHER
    DEPENDENCY_WATCHER -->|INTEGRATES_WITH| CONTROLLER_RUNTIME_SOURCE
    DEPENDENCY_WATCHER -->|USES| DEPENDENCY_TRACKER
    CONTROLLER_RUNTIME_SOURCE -->|BRIDGES_VIA| EVENT_CHANNEL_BRIDGE
    
    %% Must-Gather Diagnostic Architecture
    MUST_GATHER -->|CONTAINS| MUST_GATHER_ENGINE
    MUST_GATHER_ENGINE -->|ORCHESTRATES| HUB_DATA_COLLECTOR
    MUST_GATHER_ENGINE -->|ORCHESTRATES| MANAGED_CLUSTER_COLLECTOR
    MUST_GATHER_ENGINE -->|ORCHESTRATES| HOSTED_CLUSTER_COLLECTOR
    HUB_DATA_COLLECTOR -->|USES| POD_DATA_COLLECTOR
    MUST_GATHER_ENGINE -->|USES| RESOURCE_ORGANIZER
    RESOURCE_ORGANIZER -->|AGGREGATES_VIA| DIAGNOSTIC_AGGREGATOR
    
    %% Gatekeeper Integration
    GOV_POLICY_FRAMEWORK -->|INTEGRATES_WITH| GATEKEEPER_OP
    GATEKEEPER_FBC -->|CONFIGURES| GATEKEEPER_OP
    GATEKEEPER_OP -->|OPERATES| GATEKEEPER
    
    %% Hub to Spoke Policy Distribution
    GOV_POLICY_ADDON_CTRL -.->|DISTRIBUTES_TO| KLUSTERLET_ADDON_CTRL
    GOV_POLICY_FRAMEWORK -.->|DEPLOYS_ADDON| GOV_POLICY_FRAMEWORK_ADDON
    CONFIG_POLICY_CTRL -.->|ENFORCES_VIA| GOV_POLICY_FRAMEWORK_ADDON
    CERT_POLICY_CTRL -.->|ENFORCES_VIA| GOV_POLICY_FRAMEWORK_ADDON
    IAM_POLICY_CTRL -.->|ENFORCES_VIA| GOV_POLICY_FRAMEWORK_ADDON
    
    %% Spoke Policy Enforcement
    KLUSTERLET_ADDON_CTRL -->|INSTALLS| GOV_POLICY_FRAMEWORK_ADDON
    GOV_POLICY_FRAMEWORK_ADDON -->|MONITORS_VIA| K8S_DEPENDENCY_WATCHES
    
    %% Support Tools
    MUST_GATHER -->|COLLECTS_DATA_FROM| CONFIG_POLICY_CTRL
    MUST_GATHER -->|COLLECTS_DATA_FROM| GOV_POLICY_FRAMEWORK
    
    %% Enhanced Styling
    classDef creation fill:#e3f2fd
    classDef management fill:#f1f8e9
    classDef enforcement fill:#fff8e1
    classDef observability fill:#fce4ec
    classDef support fill:#f3e5f5
    classDef spoke fill:#e8eaf6
    classDef gatekeeper fill:#e0f2f1
    classDef controllers fill:#e1f5fe
    classDef reconcilers fill:#f0f4c3
    classDef addons fill:#fce4ec
    
    %% Creation Components
    class POLICY_GEN,POLICY_CLI,ACM_CLI,POLICY_GENERATOR_CR,PLUGIN_PROCESSING_ENGINE,POLICY_EXPANDERS creation
    class CLI_DISTRIBUTION_SERVER,CLI_BINARY_AGGREGATOR,CLI_PACKAGER,POLICY_GENERATOR_CLI,CONSOLE_CLI_DOWNLOAD cli_distribution
    
    %% Management Components  
    class GOV_POLICY_PROP,GOV_POLICY_FRAMEWORK,GOV_POLICY_ADDON_CTRL,POLICY_COLLECTION,ADDON_FACTORY,ADDON_MANAGER management
    
    %% Enhanced Reconcilers
    class ROOT_POLICY_RECONCILER,REPLICATED_POLICY_RECONCILER,ROOT_POLICY_STATUS_RECONCILER,POLICY_SET_RECONCILER,POLICY_AUTOMATION_RECONCILER,ENCRYPTION_KEYS_RECONCILER reconcilers
    
    %% Enhanced Controllers
    class SPEC_SYNC_CTRL,STATUS_SYNC_CTRL,TEMPLATE_SYNC_CTRL,SECRET_SYNC_CTRL,GATEKEEPER_SYNC_CTRL controllers
    class CONFIGURATION_POLICY_RECONCILER,OPERATOR_POLICY_RECONCILER controllers
    
    %% Enhanced Enforcement
    class CONFIG_POLICY_CTRL,CERT_POLICY_CTRL,IAM_POLICY_CTRL,DYNAMIC_WATCHER,TEMPLATE_ENGINE,NAMESPACE_SELECTOR enforcement
    class TEMPLATE_PROCESSING_ENGINE,HUB_DYNAMIC_WATCHER,GOLANG_TEMPLATE_RESOLVER,TEMPLATE_ENCRYPTION_ENGINE template_processing
    class OBJECT_EVALUATOR,NAMESPACE_SELECTOR_RECONCILER,OLM_HANDLERS,COMPLIANCE_EVALUATOR,REMEDIATION_ENGINE enforcement_engines
    class FROM_SECRET_FUNC,FROM_CONFIGMAP_FUNC,FROM_CLUSTERCLAIM_FUNC,LOOKUP_FUNC,SPRIG_FUNCTIONS template_functions
    class CERT_VALIDATION_ENGINE,DURATION_VALIDATORS,SAN_PATTERN_VALIDATORS,CERT_DISCOVERY_ENGINE,CERT_COMPLIANCE_REPORTER certificate_validation
    class EVENT_GENERATOR,METRICS_EXPORTER observability_engines
    class POLICY_PROPAGATOR_CTRL,PLACEMENT_BINDING_HANDLER,PLACEMENT_DECISION_HANDLER,PLACEMENT_RULE_HANDLER policy_propagation
    class TEMPLATE_RESOLVERS,RESOURCE_VERSION_TRACKER,STATUS_AGGREGATION_ENGINE,ROOT_COMPLIANCE_CALCULATOR,ENCRYPTION_SYSTEM propagator_internals
    class IAM_POLICY_RECONCILER,CLUSTER_ROLE_BINDING_VALIDATOR,IAM_COMPLIANCE_REPORTER,USER_THRESHOLD_VALIDATOR,CLUSTER_ADMIN_MONITOR iam_controllers
    class DEPENDENCY_WATCHER,CONTROLLER_RUNTIME_SOURCE,DEPENDENCY_TRACKER,EVENT_CHANNEL_BRIDGE dependency_watching
    class MUST_GATHER_ENGINE,HUB_DATA_COLLECTOR,MANAGED_CLUSTER_COLLECTOR,HOSTED_CLUSTER_COLLECTOR,POD_DATA_COLLECTOR,RESOURCE_ORGANIZER,DIAGNOSTIC_AGGREGATOR diagnostics
    
    %% Enhanced Addons
    class GOV_POLICY_FRAMEWORK_ADDON,GOV_STANDALONE_HUB_TEMPLATING addons
    
    %% Support & Infrastructure
    class MUST_GATHER,K8S_DEPENDENCY_WATCHES support
    class KLUSTERLET_ADDON_CTRL spoke
    class GATEKEEPER,GATEKEEPER_OP,GATEKEEPER_FBC gatekeeper